{%  extends 'base.html' %}
{%  block content %}
    <body>
        <div class="container-fluid">
            <div class="row mb-3">
                <div class="col-2">
                    <button class="btn btn-primary" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSearch"
                            aria-expanded="false" aria-controls="collapseExample">
                        Show/Hide Search
                    </button>
                </div>
                <div class="col-10">
                    <h2 class="text-center">
                        RDRG Workflow
                    </h2>
                </div>
            </div>
            <div class="collapse show" id="collapseSearch">
                <div class="container-fluid">
                    <form action="" method="get" id="fromSearch">
                        {%  csrf_token %}
                        <div class="mb-3">
                            <div Class="row g-5 align-items-center" style="padding:1px">
                                <div class="col-2" style="text-align:right">
                                    <label for="txtCriteriaDateFrom" class="col-form-label">Date from:<</label>
                                </div>
                                <div class="col-2">
                                    <input type="date" class="form-control" name="txtCriteriaDateFrom" id="txtCriteriaDateFrom" value="{{ criteriaDateFrom }}">
                                </div>
                                <div class="col-2" style="text-align:right">
                                    <label for="txtCriteriaDateTo" class="col-form-label">Date to:</label>
                                </div>
                                <div class="col-2">
                                    <input type="date" class="form-control" name="txtCriteriaDateTo" id="txtCriteriaDateTo" value="{{ criteriaDateTo }}">
                                </div>
                                <div class="col-2">
                                    <select class="form-select" name="ddlCriteriaStatus" id="ddlCriteriaStatus">
                                        <option value="NOTFINAL" {% if criteriaReportStatus == "" %} selected="selected" {% endif %}>Not Final</option>
                                        <option value="NOTFINALORNONE" {% if criteriaReportStatus == "NOTFINALORNONE" %} select="selected" {% endif %}>Written</option>
                                        <option value="NONE" {% if criteriaReportStatus == "NONE" %} selected="selected" {% endif %}>NONE</option>
                                        {% if criteriaReportStatuses %}
                                            {% for item in criteriaReportStatuses %}
                                                <option value="{{ item.REPORT_STATUS }}"
                                                        {% if item.REPORT_STATUS == criteriaReportStatus %}
                                                    selected = "selected" {% endif %}>{{ item.REPORT_STATUS }}</option>
                                            {% endfor %}
                                        {% endif %}
                                    </select>
                                </div>
                            </div>
                        <div class="row g-5 align-items-center" style="padding:1px">
                            <div class="col-2" style="text-align:right">
                                <label for="txtCriteriaLabNumber" class="col=form-label">Lab Number:</label>
                            </div>
                            <div class="col-2">
                                <input type="text" class="form-control" name="txtCriteriaLabNumber"
                                       id="txtCriteriaLabNumber" {% if criteriaLabNumber != "" %}
                                       value="{{ criteriaLabNumber }}" {% endif %}>
                            </div>
                        <div class="col-2" style="text-align:right">
                            <label for="txtCriteriaLastName" class="col-form-label">Surname:</label>
                        </div>
                        </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </body>
    <script>
    window.onload = function() {
        // Get today's date
        var today = new Date();

        // Calculate the date 5 months ago
        var fiveMonthsAgo = new Date();
        fiveMonthsAgo.setMonth(today.getMonth() - 5);

        // Calculate the date 2 months from now
        var twoMonthsFromNow = new Date();
        twoMonthsFromNow.setMonth(today.getMonth() + 2);

        // Adjust for months where the date exceeds the valid range
        if (today.getDate() !== fiveMonthsAgo.getDate()) {
            fiveMonthsAgo.setDate(0); // Set to the last day of the previous month in case of overflow
        }
        if (today.getDate() !== twoMonthsFromNow.getDate()) {
            twoMonthsFromNow.setDate(0); // Set to the last day of the overflow month
        }

        // Format the dates as YYYY-MM-DD
        function formatDate(date) {
            var day = ("0" + date.getDate()).slice(-2);
            var month = ("0" + (date.getMonth() + 1)).slice(-2);
            return date.getFullYear() + "-" + month + "-" + day;
        }

        // Set the value of the date input fields
        document.getElementById('txtCriteriaDateFrom').value = formatDate(fiveMonthsAgo);
        document.getElementById('txtCriteriaDateTo').value = formatDate(twoMonthsFromNow);
    };
</script>

{% endblock content %}